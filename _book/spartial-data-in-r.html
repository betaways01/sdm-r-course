<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Spartial Data in R | A Minimal Book Example</title>
<meta name="author" content="Basim Alsaedi">
<meta name="description" content="4.0.1 1. Introduction In the previous section, we learned about spatial data and why it‚Äôs important for understanding species distribution and the environment. Now, we will move forward by...">
<meta name="generator" content="bookdown 0.41 with bs4_book()">
<meta property="og:title" content="Chapter 4 Spartial Data in R | A Minimal Book Example">
<meta property="og:type" content="book">
<meta property="og:description" content="4.0.1 1. Introduction In the previous section, we learned about spatial data and why it‚Äôs important for understanding species distribution and the environment. Now, we will move forward by...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Spartial Data in R | A Minimal Book Example">
<meta name="twitter:description" content="4.0.1 1. Introduction In the previous section, we learned about spatial data and why it‚Äôs important for understanding species distribution and the environment. Now, we will move forward by...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0.9000/transition.js"></script><script src="libs/bs3compat-0.8.0.9000/tabs.js"></script><script src="libs/bs3compat-0.8.0.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Minimal Book Example</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="understanding-spatial-data.html"><span class="header-section-number">3</span> Understanding Spatial Data</a></li>
<li><a class="active" href="spartial-data-in-r.html"><span class="header-section-number">4</span> Spartial Data in R</a></li>
<li><a class="" href="key-spatial-concepts-and-terminologies.html"><span class="header-section-number">5</span> Key Spatial Concepts and Terminologies</a></li>
<li><a class="" href="steps-in-species-distribution-modeling-sdm.html"><span class="header-section-number">6</span> Steps in Species Distribution Modeling (SDM)</a></li>
<li><a class="" href="sdm-techniques.html"><span class="header-section-number">7</span> SDM Techniques</a></li>
<li><a class="" href="maxent-algorithm.html"><span class="header-section-number">8</span> Maxent Algorithm</a></li>
<li><a class="" href="exercise.html"><span class="header-section-number">9</span> Exercise</a></li>
<li><a class="" href="maxent-bias-correction.html"><span class="header-section-number">10</span> Maxent Bias Correction</a></li>
<li><a class="" href="cart-rf-and-gbm.html"><span class="header-section-number">11</span> Cart, RF, and GBM</a></li>
<li><a class="" href="gbm-variable-selection.html"><span class="header-section-number">12</span> GBM Variable Selection</a></li>
<li><a class="" href="model-evaluation-in-sdm.html"><span class="header-section-number">13</span> Model Evaluation in SDM</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="spartial-data-in-r" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Spartial Data in R<a class="anchor" aria-label="anchor" href="#spartial-data-in-r"><i class="fas fa-link"></i></a>
</h1>
<hr>
<div id="introduction-1" class="section level3" number="4.0.1">
<h3>
<span class="header-section-number">4.0.1</span> <strong>1. Introduction</strong><a class="anchor" aria-label="anchor" href="#introduction-1"><i class="fas fa-link"></i></a>
</h3>
<hr>
<p>In the previous section, we learned about <strong>spatial data</strong> and why it‚Äôs important for understanding species distribution and the environment. Now, we will move forward by learning how to actually work with this data in <strong>R</strong>.</p>
<hr>
<p>This part of the tutorial will show you step by step:</p>
<ul>
<li>How to <strong>create vector data</strong> (like points, lines, and polygons).</li>
<li>How to <strong>make raster layers</strong> and combine them into stacks and bricks.</li>
<li>How to <strong>set and change projections</strong> so that your data lines up correctly on a map.</li>
<li>How to <strong>get real-world data</strong>, like climate information and species locations, which you can use to build models.</li>
</ul>
<hr>
<p>By following along, you‚Äôll learn basic methods for handling both <strong>vector</strong> and <strong>raster data</strong> in R. You‚Äôll also get familiar with common GIS tasks like reading, writing, and transforming spatial data.</p>
<p>Let‚Äôs start! üåç</p>
</div>
<div id="working-with-vector-data-in-r" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> ### <strong>2. Working with Vector Data in R</strong><a class="anchor" aria-label="anchor" href="#working-with-vector-data-in-r"><i class="fas fa-link"></i></a>
</h2>
<p>Vector data includes points, lines, and polygons. In this section, we will focus on <strong>creating point data</strong>, converting it into a <strong>spatial object</strong>, and adding <strong>attribute data</strong>.</p>
<hr>
<div id="creating-point-data" class="section level4" number="4.1.0.1">
<h4>
<span class="header-section-number">4.1.0.1</span> <strong>2.1. Creating Point Data</strong><a class="anchor" aria-label="anchor" href="#creating-point-data"><i class="fas fa-link"></i></a>
</h4>
<p>To start, we need to create a set of points using longitude and latitude values. In R, this can be done using simple vectors.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Creating vectors for longitude and latitude</span></span>
<span><span class="va">longitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">116.7</span>, <span class="op">-</span><span class="fl">120.4</span>, <span class="op">-</span><span class="fl">116.7</span>, <span class="op">-</span><span class="fl">113.5</span>, <span class="op">-</span><span class="fl">115.5</span><span class="op">)</span></span>
<span><span class="va">latitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45.3</span>, <span class="fl">42.6</span>, <span class="fl">38.9</span>, <span class="fl">42.1</span>, <span class="fl">35.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into a matrix of coordinates</span></span>
<span><span class="va">lonlat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">longitude</span>, <span class="va">latitude</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the points</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">lonlat</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span>, xlab <span class="op">=</span> <span class="st">"Longitude"</span>, ylab <span class="op">=</span> <span class="st">"Latitude"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Plot of Longitude and Latitude Points"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-1-1.png" width="672"></div>
<div class="rmdnote">
<ul>
<li>
<strong>Order matters</strong>: Always specify coordinates as <code>(longitude, latitude)</code>, not <code>(latitude, longitude)</code>. This follows the common geographic convention.</li>
<li>The <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> function gives a quick view of the points.</li>
</ul>
</div>
<hr>
</div>
<div id="converting-to-a-spatial-object" class="section level4" number="4.1.0.2">
<h4>
<span class="header-section-number">4.1.0.2</span> <strong>2.2. Converting to a Spatial Object</strong><a class="anchor" aria-label="anchor" href="#converting-to-a-spatial-object"><i class="fas fa-link"></i></a>
</h4>
<p>Although we have plotted the points, they are not yet considered <strong>spatial data</strong>. To work with spatial data, we need to convert these points into a <code>SpatialPoints</code> object.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the 'sp' package for spatial data handling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a SpatialPoints object</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/SpatialPoints.html">SpatialPoints</a></span><span class="op">(</span><span class="va">lonlat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the class of the object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "SpatialPoints"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "sp"</span></span></code></pre></div>
<div class="rmdtip">
<p>The <code>sp</code> package is a core tool for handling vector data in R. <code>SpatialPoints</code> objects store spatial information, but they don‚Äôt yet have any associated attributes.</p>
</div>
<hr>
</div>
<div id="assigning-a-coordinate-reference-system-crs" class="section level4" number="4.1.0.3">
<h4>
<span class="header-section-number">4.1.0.3</span> <strong>Assigning a Coordinate Reference System (CRS)</strong><a class="anchor" aria-label="anchor" href="#assigning-a-coordinate-reference-system-crs"><i class="fas fa-link"></i></a>
</h4>
<p>A <strong>CRS</strong> defines how the spatial data relates to locations on Earth. Without a CRS, your points won‚Äôt align properly with other spatial datasets.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign a CRS to the SpatialPoints object</span></span>
<span><span class="va">crs_string</span> <span class="op">&lt;-</span> <span class="st">"+proj=longlat +datum=WGS84"</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/SpatialPoints.html">SpatialPoints</a></span><span class="op">(</span><span class="va">lonlat</span>, proj4string <span class="op">=</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/CRS-class.html">CRS</a></span><span class="op">(</span><span class="va">crs_string</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pts</span></span>
<span><span class="co">#&gt; SpatialPoints:</span></span>
<span><span class="co">#&gt;      longitude latitude</span></span>
<span><span class="co">#&gt; [1,]    -116.7     45.3</span></span>
<span><span class="co">#&gt; [2,]    -120.4     42.6</span></span>
<span><span class="co">#&gt; [3,]    -116.7     38.9</span></span>
<span><span class="co">#&gt; [4,]    -113.5     42.1</span></span>
<span><span class="co">#&gt; [5,]    -115.5     35.7</span></span>
<span><span class="co">#&gt; Coordinate Reference System (CRS) arguments:</span></span>
<span><span class="co">#&gt; +proj=longlat +datum=WGS84 +no_defs</span></span></code></pre></div>
<div class="rmdcaution">
<p>Always assign a CRS when working with spatial data!<br>
In most cases, use <code>"+proj=longlat +datum=WGS84"</code> for data with longitude and latitude coordinates.</p>
</div>
<hr>
</div>
<div id="creating-a-spatialpointsdataframe" class="section level4" number="4.1.0.4">
<h4>
<span class="header-section-number">4.1.0.4</span> <strong>2.3. Creating a <code>SpatialPointsDataFrame</code></strong><a class="anchor" aria-label="anchor" href="#creating-a-spatialpointsdataframe"><i class="fas fa-link"></i></a>
</h4>
<p>A <code>SpatialPointsDataFrame</code> combines spatial data with <strong>attribute data</strong>. Let‚Äôs add some random precipitation values to our points.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a data frame of attribute data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span><span class="va">precipValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">lonlat</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>  <span class="co"># Random precipitation values</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">lonlat</span><span class="op">)</span>, precip <span class="op">=</span> <span class="va">precipValue</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the SpatialPoints object with the attribute data</span></span>
<span><span class="va">ptsdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/SpatialPoints.html">SpatialPointsDataFrame</a></span><span class="op">(</span><span class="va">pts</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the first few rows of the data</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html">head</a></span><span class="op">(</span><span class="va">ptsdf</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID   precip</span></span>
<span><span class="co">#&gt; 1  1 91.48060</span></span>
<span><span class="co">#&gt; 2  2 93.70754</span></span>
<span><span class="co">#&gt; 3  3 28.61395</span></span>
<span><span class="co">#&gt; 4  4 83.04476</span></span>
<span><span class="co">#&gt; 5  5 64.17455</span></span></code></pre></div>
<hr>
</div>
<div id="output-check" class="section level4" number="4.1.0.5">
<h4>
<span class="header-section-number">4.1.0.5</span> <strong>Output Check</strong><a class="anchor" aria-label="anchor" href="#output-check"><i class="fas fa-link"></i></a>
</h4>
<p>You can access both the <strong>coordinates</strong> and <strong>attributes</strong> separately.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access the spatial coordinates</span></span>
<span><span class="va">ptsdf</span><span class="op">@</span><span class="va">coords</span></span>
<span><span class="co">#&gt;      longitude latitude</span></span>
<span><span class="co">#&gt; [1,]    -116.7     45.3</span></span>
<span><span class="co">#&gt; [2,]    -120.4     42.6</span></span>
<span><span class="co">#&gt; [3,]    -116.7     38.9</span></span>
<span><span class="co">#&gt; [4,]    -113.5     42.1</span></span>
<span><span class="co">#&gt; [5,]    -115.5     35.7</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access the attribute data</span></span>
<span><span class="va">ptsdf</span><span class="op">@</span><span class="va">data</span></span>
<span><span class="co">#&gt;   ID   precip</span></span>
<span><span class="co">#&gt; 1  1 91.48060</span></span>
<span><span class="co">#&gt; 2  2 93.70754</span></span>
<span><span class="co">#&gt; 3  3 28.61395</span></span>
<span><span class="co">#&gt; 4  4 83.04476</span></span>
<span><span class="co">#&gt; 5  5 64.17455</span></span></code></pre></div>
<div class="rmdtip">
<ul>
<li>Use <code>ptsdf@coords</code> to extract the spatial coordinates.</li>
<li>Use <code>ptsdf@data</code> to extract the non-spatial attribute data.</li>
</ul>
</div>
<hr>
</div>
<div id="plotting-the-data" class="section level4" number="4.1.0.6">
<h4>
<span class="header-section-number">4.1.0.6</span> <strong>Plotting the Data</strong><a class="anchor" aria-label="anchor" href="#plotting-the-data"><i class="fas fa-link"></i></a>
</h4>
<p>We can now visualize the points on a simple plot, coloring them based on precipitation values.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with color based on precipitation</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ptsdf</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/cut.html">cut</a></span><span class="op">(</span><span class="va">ptsdf</span><span class="op">$</span><span class="va">precip</span>, breaks <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Spatial Points with Precipitation"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Precipitation"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
<hr>
</div>
<div id="summary" class="section level3" number="4.1.1">
<h3>
<span class="header-section-number">4.1.1</span> <strong>Summary</strong><a class="anchor" aria-label="anchor" href="#summary"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>We learned how to <strong>create point data</strong> using longitude and latitude.</li>
<li>We converted the points into a <strong>spatial object</strong> using the <code>sp</code> package.</li>
<li>We added <strong>attribute data</strong> to create a <code>SpatialPointsDataFrame</code>.</li>
<li>Finally, we plotted the points with precipitation values.</li>
</ul>
</div>
<div id="creating-and-manipulating-raster-data-in-r" class="section level3" number="4.1.2">
<h3>
<span class="header-section-number">4.1.2</span> <strong>3. Creating and Manipulating Raster Data in R</strong><a class="anchor" aria-label="anchor" href="#creating-and-manipulating-raster-data-in-r"><i class="fas fa-link"></i></a>
</h3>
<div id="creating-a-rasterlayer" class="section level4" number="4.1.2.1">
<h4>
<span class="header-section-number">4.1.2.1</span> <strong>3.1. Creating a <code>RasterLayer</code></strong><a class="anchor" aria-label="anchor" href="#creating-a-rasterlayer"><i class="fas fa-link"></i></a>
</h4>
<p>A <strong>raster</strong> represents spatial data as a grid of cells, where each cell has a value. This is useful for continuous data like temperature, elevation, or land cover.</p>
<p>We‚Äôll start by creating a blank raster with <strong>10 columns</strong> and <strong>10 rows</strong>, and we‚Äôll define its extent (the geographic area it covers).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the 'raster' package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a blank raster with specific extent and resolution</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">10</span>, nrow <span class="op">=</span> <span class="fl">10</span>, xmx <span class="op">=</span> <span class="op">-</span><span class="fl">80</span>, xmn <span class="op">=</span> <span class="op">-</span><span class="fl">150</span>, ymn <span class="op">=</span> <span class="fl">20</span>, ymx <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print raster details</span></span>
<span><span class="va">r</span></span>
<span><span class="co">#&gt; class      : RasterLayer </span></span>
<span><span class="co">#&gt; dimensions : 10, 10, 100  (nrow, ncol, ncell)</span></span>
<span><span class="co">#&gt; resolution : 7, 4  (x, y)</span></span>
<span><span class="co">#&gt; extent     : -150, -80, 20, 60  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; crs        : +proj=longlat +datum=WGS84 +no_defs</span></span></code></pre></div>
<div class="rmdnote">
<ul>
<li>The raster has <strong>10 columns</strong> and <strong>10 rows</strong>, meaning there are 100 cells in total.</li>
<li>The extent specifies the geographic boundaries:
<ul>
<li>
<code>xmn = -150</code> and <code>xmx = -80</code> (longitude range)</li>
<li>
<code>ymn = 20</code> and <code>ymx = 60</code> (latitude range)</li>
</ul>
</li>
<li>The default <strong>Coordinate Reference System (CRS)</strong> is <code>WGS84</code>, which uses longitude and latitude.</li>
</ul>
</div>
<hr>
</div>
<div id="adding-values-to-the-raster" class="section level4" number="4.1.2.2">
<h4>
<span class="header-section-number">4.1.2.2</span> <strong>3.2. Adding Values to the Raster</strong><a class="anchor" aria-label="anchor" href="#adding-values-to-the-raster"><i class="fas fa-link"></i></a>
</h4>
<p>Now that we have a blank raster, we can assign values to its cells. Let‚Äôs assign random values between 0 and 100 using the <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> function, which generates random numbers.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign random values to the raster cells</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html">ncell</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the raster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">r</span>, main <span class="op">=</span> <span class="st">"Random Values Raster"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<div class="rmdtip">
<ul>
<li>The <code><a href="https://rspatial.github.io/terra/reference/dimensions.html">ncell()</a></code> function returns the total number of cells in the raster.</li>
<li>The <code><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors()</a></code> function is used to create a nice color gradient for the plot.</li>
</ul>
</div>
<hr>
</div>
<div id="creating-a-rasterstack" class="section level4" number="4.1.2.3">
<h4>
<span class="header-section-number">4.1.2.3</span> <strong>3.3. Creating a <code>RasterStack</code></strong><a class="anchor" aria-label="anchor" href="#creating-a-rasterstack"><i class="fas fa-link"></i></a>
</h4>
<p>A <strong><code>RasterStack</code></strong> is a collection of multiple rasters with the same extent and resolution. This is useful when you have multiple layers of data for the same area, such as temperature, precipitation, and elevation.</p>
<p>Let‚Äôs create two more rasters and stack them together.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create two more rasters by performing operations on the original raster</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="fl">2</span>   <span class="co"># Multiply all values by 2</span></span>
<span><span class="va">r3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="co"># Take the square root of all values</span></span>
<span></span>
<span><span class="co"># Create a RasterStack</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html">stack</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">r2</span>, <span class="va">r3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the RasterStack with enhanced visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">s</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Layer 1: Random Values"</span>, <span class="st">"Layer 2: Values * 2"</span>, <span class="st">"Layer 3: Square Root"</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, nr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<div class="rmdnote">
<ul>
<li>All rasters in the stack must have the <strong>same resolution</strong> and <strong>extent</strong>.</li>
<li>You can stack as many rasters as you need.</li>
</ul>
</div>
<hr>
</div>
<div id="creating-a-rasterbrick" class="section level4" number="4.1.2.4">
<h4>
<span class="header-section-number">4.1.2.4</span> <strong>3.4. Creating a <code>RasterBrick</code></strong><a class="anchor" aria-label="anchor" href="#creating-a-rasterbrick"><i class="fas fa-link"></i></a>
</h4>
<p>A <strong><code>RasterBrick</code></strong> is similar to a <code>RasterStack</code>, but it is stored more efficiently in memory. This makes it faster to process when working with large datasets.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a RasterBrick from the RasterStack</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html">brick</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the RasterBrick with enhanced visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">b</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Layer 1: Random Values"</span>, <span class="st">"Layer 2: Values * 2"</span>, <span class="st">"Layer 3: Square Root"</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, nr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-10-1.png" width="672"></div>
<div class="rmdtip">
<ul>
<li>Use a <code>RasterBrick</code> when you need better performance and memory efficiency.</li>
<li>A <code>RasterBrick</code> is particularly useful when dealing with large datasets, such as satellite imagery or time-series data.</li>
</ul>
</div>
<hr>
<div id="key-takeaways-2" class="section level5" number="4.1.2.4.1">
<h5>
<span class="header-section-number">4.1.2.4.1</span> <strong>Key Takeaways</strong><a class="anchor" aria-label="anchor" href="#key-takeaways-2"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>
<strong>RasterLayer</strong>: A grid of cells representing spatial data.</li>
<li>
<strong>RasterStack</strong>: A collection of rasters with the same resolution and extent.</li>
<li>
<strong>RasterBrick</strong>: A more memory-efficient version of a <code>RasterStack</code>.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="working-with-coordinate-reference-systems-crs" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> ### <strong>4. Working with Coordinate Reference Systems (CRS)</strong><a class="anchor" aria-label="anchor" href="#working-with-coordinate-reference-systems-crs"><i class="fas fa-link"></i></a>
</h2>
<div id="assigning-and-transforming-crs" class="section level4" number="4.2.0.1">
<h4>
<span class="header-section-number">4.2.0.1</span> <strong>4.1. Assigning and Transforming CRS</strong><a class="anchor" aria-label="anchor" href="#assigning-and-transforming-crs"><i class="fas fa-link"></i></a>
</h4>
<p>When working with spatial data, ensuring that all layers share a common CRS is crucial for proper alignment and accurate analysis. Let‚Äôs walk through assigning a CRS and transforming it to a new one using <strong>vector</strong> and <strong>raster data</strong>.</p>
<hr>
<div id="assigning-a-crs-to-vector-data" class="section level5" number="4.2.0.1.1">
<h5>
<span class="header-section-number">4.2.0.1.1</span> <strong>Assigning a CRS to Vector Data</strong><a class="anchor" aria-label="anchor" href="#assigning-a-crs-to-vector-data"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2()</span></span>
<span><span class="co">#&gt; is TRUE</span></span>
<span></span>
<span><span class="co"># Create sample point data</span></span>
<span><span class="va">longitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">116.7</span>, <span class="op">-</span><span class="fl">120.4</span>, <span class="op">-</span><span class="fl">116.7</span>, <span class="op">-</span><span class="fl">113.5</span>, <span class="op">-</span><span class="fl">115.5</span><span class="op">)</span></span>
<span><span class="va">latitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45.3</span>, <span class="fl">42.6</span>, <span class="fl">38.9</span>, <span class="fl">42.1</span>, <span class="fl">35.7</span><span class="op">)</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">longitude</span>, <span class="va">latitude</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to an sf object and assign WGS84 CRS</span></span>
<span><span class="va">sf_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">pts</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View CRS of the spatial object</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">sf_pts</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coordinate Reference System:</span></span>
<span><span class="co">#&gt;   User input: EPSG:4326 </span></span>
<span><span class="co">#&gt;   wkt:</span></span>
<span><span class="co">#&gt; GEOGCRS["WGS 84",</span></span>
<span><span class="co">#&gt;     ENSEMBLE["World Geodetic System 1984 ensemble",</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (Transit)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G730)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G873)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G1150)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G1674)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G1762)"],</span></span>
<span><span class="co">#&gt;         MEMBER["World Geodetic System 1984 (G2139)"],</span></span>
<span><span class="co">#&gt;         ELLIPSOID["WGS 84",6378137,298.257223563,</span></span>
<span><span class="co">#&gt;             LENGTHUNIT["metre",1]],</span></span>
<span><span class="co">#&gt;         ENSEMBLEACCURACY[2.0]],</span></span>
<span><span class="co">#&gt;     PRIMEM["Greenwich",0,</span></span>
<span><span class="co">#&gt;         ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">#&gt;     CS[ellipsoidal,2],</span></span>
<span><span class="co">#&gt;         AXIS["geodetic latitude (Lat)",north,</span></span>
<span><span class="co">#&gt;             ORDER[1],</span></span>
<span><span class="co">#&gt;             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">#&gt;         AXIS["geodetic longitude (Lon)",east,</span></span>
<span><span class="co">#&gt;             ORDER[2],</span></span>
<span><span class="co">#&gt;             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">#&gt;     USAGE[</span></span>
<span><span class="co">#&gt;         SCOPE["Horizontal component of 3D system."],</span></span>
<span><span class="co">#&gt;         AREA["World."],</span></span>
<span><span class="co">#&gt;         BBOX[-90,-180,90,180]],</span></span>
<span><span class="co">#&gt;     ID["EPSG",4326]]</span></span></code></pre></div>
<div class="rmdnote">
<ul>
<li>The <strong>EPSG code <code>4326</code></strong> corresponds to the <strong>WGS84</strong> geographic CRS, commonly used for data with longitude and latitude coordinates.</li>
<li>Using <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf()</a></code> converts the data frame into a spatial object.</li>
</ul>
</div>
<hr>
</div>
<div id="transforming-vector-data-to-a-new-crs" class="section level5" number="4.2.0.1.2">
<h5>
<span class="header-section-number">4.2.0.1.2</span> <strong>Transforming Vector Data to a New CRS</strong><a class="anchor" aria-label="anchor" href="#transforming-vector-data-to-a-new-crs"><i class="fas fa-link"></i></a>
</h5>
<p>Let‚Äôs transform the spatial data from <strong>WGS84</strong> to a <strong>Robinson projection</strong>.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the new CRS (Robinson projection)</span></span>
<span><span class="va">new_crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=robin +datum=WGS84"</span></span>
<span></span>
<span><span class="co"># Transform the spatial points to the new CRS</span></span>
<span><span class="va">sf_pts_transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">sf_pts</span>, crs <span class="op">=</span> <span class="va">new_crs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the original and transformed data side by side</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Set plotting layout</span></span>
<span></span>
<span><span class="co"># Original data in WGS84</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">sf_pts</span>, main <span class="op">=</span> <span class="st">"Original CRS: WGS84"</span>, col <span class="op">=</span> <span class="st">"blue"</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Transformed data in Robinson projection</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">sf_pts_transformed</span>, main <span class="op">=</span> <span class="st">"Transformed CRS: Robinson"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-12-2.png" width="672"></div>
<div class="rmdcaution">
<ul>
<li>Different CRSs can distort distances, areas, and angles differently, depending on their projection method.</li>
<li>Always choose a CRS that fits your analysis needs (e.g., <strong>UTM</strong> for local-scale accuracy, <strong>Albers Equal-Area</strong> for area-preserving studies).</li>
</ul>
</div>
<hr>
</div>
</div>
<div id="projecting-raster-data" class="section level4" number="4.2.0.2">
<h4>
<span class="header-section-number">4.2.0.2</span> <strong>4.2. Projecting Raster Data</strong><a class="anchor" aria-label="anchor" href="#projecting-raster-data"><i class="fas fa-link"></i></a>
</h4>
<p>Projecting raster data involves recalculating cell values and adjusting the resolution to fit the new CRS. Let‚Äôs demonstrate this using a raster dataset.</p>
<hr>
<div id="reprojecting-a-raster" class="section level5" number="4.2.0.2.1">
<h5>
<span class="header-section-number">4.2.0.2.1</span> <strong>Reprojecting a Raster</strong><a class="anchor" aria-label="anchor" href="#reprojecting-a-raster"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.8.5</span></span>
<span></span>
<span><span class="co"># Create a sample raster</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html">rast</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">10</span>, nrow <span class="op">=</span> <span class="fl">10</span>, xmin <span class="op">=</span> <span class="op">-</span><span class="fl">150</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">80</span>, ymin <span class="op">=</span> <span class="fl">20</span>, ymax <span class="op">=</span> <span class="fl">60</span>, crs <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html">ncell</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>  <span class="co"># Assign random values</span></span>
<span></span>
<span><span class="co"># Define a new CRS (Lambert Conformal Conic projection)</span></span>
<span><span class="va">new_crs_raster</span> <span class="op">&lt;-</span> <span class="st">"+proj=lcc +lat_1=48 +lat_2=33 +lon_0=-100 +datum=WGS84"</span></span>
<span></span>
<span><span class="co"># Project the raster to the new CRS</span></span>
<span><span class="va">r_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/project.html">project</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">new_crs_raster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot original and reprojected raster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Original raster in WGS84</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">r</span>, main <span class="op">=</span> <span class="st">"Original CRS: WGS84"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Projected raster in Lambert Conformal Conic</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">r_projected</span>, main <span class="op">=</span> <span class="st">"Projected CRS: LCC"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
<hr>
<div class="rmdtip">
<ul>
<li>The <code><a href="https://rspatial.github.io/terra/reference/project.html">project()</a></code> function from the <strong>terra</strong> package is used for raster reprojection.</li>
<li>Ensure that the target CRS is defined using PROJ.4 strings or EPSG codes.</li>
</ul>
</div>
<hr>
</div>
</div>
<div id="key-takeaways-3" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> <strong>Key Takeaways</strong><a class="anchor" aria-label="anchor" href="#key-takeaways-3"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Always ensure that your spatial datasets use the same CRS before performing analysis.</li>
<li>Use <code><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs()</a></code> and <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform()</a></code> for vector data and <code><a href="https://rspatial.github.io/terra/reference/crs.html">crs()</a></code> and <code><a href="https://rspatial.github.io/terra/reference/project.html">project()</a></code> for raster data.</li>
<li>Choose appropriate CRSs based on the scope and goals of your project.</li>
</ul>
</div>
</div>
<div id="reading-and-writing-spatial-data" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> ### <strong>5. Reading and Writing Spatial Data</strong><a class="anchor" aria-label="anchor" href="#reading-and-writing-spatial-data"><i class="fas fa-link"></i></a>
</h2>
<div id="reading-shapefiles-and-rasters" class="section level4" number="4.3.0.1">
<h4>
<span class="header-section-number">4.3.0.1</span> <strong>5.1. Reading Shapefiles and Rasters</strong><a class="anchor" aria-label="anchor" href="#reading-shapefiles-and-rasters"><i class="fas fa-link"></i></a>
</h4>
<p>Working with spatial data often starts by <strong>reading external files</strong> such as shapefiles and raster datasets. R provides convenient functions to load these files into spatial objects for analysis.</p>
<hr>
<div id="reading-a-shapefile" class="section level5" number="4.3.0.1.1">
<h5>
<span class="header-section-number">4.3.0.1.1</span> <strong>Reading a Shapefile</strong><a class="anchor" aria-label="anchor" href="#reading-a-shapefile"><i class="fas fa-link"></i></a>
</h5>
<p>Let‚Äôs read a sample shapefile provided by the <code>raster</code> package.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read a sample shapefile (comes with the 'raster' package)</span></span>
<span><span class="va">shapefile_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/lux.shp"</span>, package <span class="op">=</span> <span class="st">"raster"</span><span class="op">)</span></span>
<span><span class="va">shape_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/shapefile.html">shapefile</a></span><span class="op">(</span><span class="va">shapefile_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print basic information about the shapefile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">shape_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatialPolygonsDataFrame </span></span>
<span><span class="co">#&gt; features    : 12 </span></span>
<span><span class="co">#&gt; extent      : 5.74414, 6.528252, 49.44781, 50.18162  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; crs         : +proj=longlat +datum=WGS84 +no_defs </span></span>
<span><span class="co">#&gt; variables   : 5</span></span>
<span><span class="co">#&gt; names       : ID_1,     NAME_1, ID_2,   NAME_2, AREA </span></span>
<span><span class="co">#&gt; min values  :    1,   Diekirch,    1, Capellen,   76 </span></span>
<span><span class="co">#&gt; max values  :    3, Luxembourg,   12,    Wiltz,  312</span></span>
<span></span>
<span><span class="co"># Plot the shapefile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">shape_data</span>, main <span class="op">=</span> <span class="st">"Sample Shapefile (Luxembourg)"</span>, col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<div class="rmdnote">
<ul>
<li>The function <code><a href="https://rdrr.io/pkg/raster/man/shapefile.html">shapefile()</a></code> reads vector data in <strong>shapefile format</strong> and loads it as a <code>Spatial*</code> object.</li>
<li>The <code><a href="https://rdrr.io/r/base/system.file.html">system.file()</a></code> function retrieves the path to a sample shapefile provided by the package.</li>
</ul>
</div>
<hr>
</div>
<div id="reading-a-raster-file" class="section level5" number="4.3.0.1.2">
<h5>
<span class="header-section-number">4.3.0.1.2</span> <strong>Reading a Raster File</strong><a class="anchor" aria-label="anchor" href="#reading-a-raster-file"><i class="fas fa-link"></i></a>
</h5>
<p>Now, let‚Äôs load a sample raster dataset, also provided by the <code>raster</code> package.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a sample raster file (comes with the 'raster' package)</span></span>
<span><span class="va">raster_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/test.grd"</span>, package <span class="op">=</span> <span class="st">"raster"</span><span class="op">)</span></span>
<span><span class="va">raster_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">(</span><span class="va">raster_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print raster information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">raster_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; class      : RasterLayer </span></span>
<span><span class="co">#&gt; dimensions : 115, 80, 9200  (nrow, ncol, ncell)</span></span>
<span><span class="co">#&gt; resolution : 40, 40  (x, y)</span></span>
<span><span class="co">#&gt; extent     : 178400, 181600, 329400, 334000  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; crs        : +proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +datum=WGS84 +units=m +no_defs </span></span>
<span><span class="co">#&gt; source     : test.grd </span></span>
<span><span class="co">#&gt; names      : test </span></span>
<span><span class="co">#&gt; values     : 138.7071, 1736.058  (min, max)</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the raster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">raster_data</span>, main <span class="op">=</span> <span class="st">"Sample Raster Data"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<div class="rmdtip">
<ul>
<li>The function <code><a href="https://rdrr.io/pkg/raster/man/raster.html">raster()</a></code> reads raster files and loads them as <code>RasterLayer</code> objects.</li>
<li>Use <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> to display basic metadata, such as resolution, extent, and CRS.</li>
</ul>
</div>
<hr>
</div>
</div>
<div id="writing-spatial-data-to-disk" class="section level4" number="4.3.0.2">
<h4>
<span class="header-section-number">4.3.0.2</span> <strong>5.2. Writing Spatial Data to Disk</strong><a class="anchor" aria-label="anchor" href="#writing-spatial-data-to-disk"><i class="fas fa-link"></i></a>
</h4>
<p>Once you‚Äôve processed your spatial data, you‚Äôll often want to <strong>save it to disk</strong> for sharing or future use. Let‚Äôs see how to save both shapefiles and rasters.</p>
<hr>
<div id="saving-a-shapefile" class="section level5" number="4.3.0.2.1">
<h5>
<span class="header-section-number">4.3.0.2.1</span> <strong>Saving a Shapefile</strong><a class="anchor" aria-label="anchor" href="#saving-a-shapefile"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define output file path</span></span>
<span><span class="va">output_shapefile</span> <span class="op">&lt;-</span> <span class="st">"output_shapefile.shp"</span></span>
<span></span>
<span><span class="co"># Save the shapefile to disk</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/shapefile.html">shapefile</a></span><span class="op">(</span><span class="va">shape_data</span>, filename <span class="op">=</span> <span class="va">output_shapefile</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confirm the file was created</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"output_shapefile*"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "output_shapefile.cpg" "output_shapefile.dbf"</span></span>
<span><span class="co">#&gt; [3] "output_shapefile.prj" "output_shapefile.shp"</span></span>
<span><span class="co">#&gt; [5] "output_shapefile.shx"</span></span></code></pre></div>
<div class="rmdtip">
<ul>
<li>The <code><a href="https://rdrr.io/pkg/raster/man/shapefile.html">shapefile()</a></code> function writes a <code>Spatial*</code> object to disk in shapefile format.</li>
<li>Always set <code>overwrite = TRUE</code> if you want to overwrite existing files.</li>
</ul>
</div>
<hr>
</div>
<div id="saving-a-raster" class="section level5" number="4.3.0.2.2">
<h5>
<span class="header-section-number">4.3.0.2.2</span> <strong>Saving a Raster</strong><a class="anchor" aria-label="anchor" href="#saving-a-raster"><i class="fas fa-link"></i></a>
</h5>
<p>Let‚Äôs save the raster we read earlier to a new file in <strong>GeoTIFF</strong> format.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define output file path</span></span>
<span><span class="va">output_raster</span> <span class="op">&lt;-</span> <span class="st">"output_raster.tif"</span></span>
<span></span>
<span><span class="co"># Save the raster to disk</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster</a></span><span class="op">(</span><span class="va">raster_data</span>, filename <span class="op">=</span> <span class="va">output_raster</span>, format <span class="op">=</span> <span class="st">"GTiff"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confirm the file was created</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"output_raster*"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "output_raster.tif"</span></span></code></pre></div>
<div class="rmdnote">
<ul>
<li>The <code><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster()</a></code> function writes raster data to various formats, including <strong>GeoTIFF</strong>, <strong>NetCDF</strong>, and <strong>ASCII Grid</strong>.</li>
<li>Set <code>format = "GTiff"</code> to specify the file format as GeoTIFF.</li>
</ul>
</div>
<hr>
</div>
</div>
<div id="key-takeaways-4" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> <strong>Key Takeaways</strong><a class="anchor" aria-label="anchor" href="#key-takeaways-4"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Use <code><a href="https://rdrr.io/pkg/raster/man/shapefile.html">shapefile()</a></code> to <strong>read</strong> and <strong>write shapefiles</strong>.</li>
<li>Use <code><a href="https://rdrr.io/pkg/raster/man/raster.html">raster()</a></code> and <code><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster()</a></code> for <strong>reading</strong> and <strong>saving raster data</strong>.</li>
<li>The <code><a href="https://rdrr.io/r/base/system.file.html">system.file()</a></code> function is useful for accessing sample datasets bundled with R packages.</li>
<li>Always check the CRS, resolution, and extent of your data to ensure proper alignment when saving files.</li>
</ul>
</div>
</div>
<div id="practical-applications-in-sdm" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> ### <strong>6. Practical Applications in SDM</strong><a class="anchor" aria-label="anchor" href="#practical-applications-in-sdm"><i class="fas fa-link"></i></a>
</h2>
<p>Species Distribution Modeling (<strong>SDM</strong>) involves predicting the geographic distribution of species based on <strong>environmental data</strong> (e.g., climate variables) and <strong>species occurrence data</strong> (e.g., observed locations of a species). In this section, we‚Äôll demonstrate how to:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Download environmental data</strong> using the <code><a href="https://rdrr.io/pkg/raster/man/getData.html">getData()</a></code> function from the <strong><code>dismo</code></strong> package.<br>
</li>
<li>
<strong>Retrieve species occurrence data</strong> from <strong>GBIF</strong> using the <code><a href="https://rdrr.io/pkg/dismo/man/gbif.html">gbif()</a></code> function.</li>
</ol>
<hr>
<div id="downloading-environmental-data" class="section level4" number="4.4.0.1">
<h4>
<span class="header-section-number">4.4.0.1</span> <strong>6.1. Downloading Environmental Data</strong><a class="anchor" aria-label="anchor" href="#downloading-environmental-data"><i class="fas fa-link"></i></a>
</h4>
<p>Bioclimatic variables are commonly used in SDM. These variables represent different climate characteristics, such as annual mean temperature, temperature seasonality, and annual precipitation.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">geodata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify a directory to save the data</span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Temporary directory for demonstration purposes</span></span>
<span></span>
<span><span class="co"># Download bioclimatic variables at 10-minute resolution</span></span>
<span><span class="va">bioclim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geodata/man/worldclim.html">worldclim_global</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bio"</span>, res <span class="op">=</span> <span class="fl">10</span>, path <span class="op">=</span> <span class="va">data_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the structure of the raster stack</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bioclim_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 1080, 2160, 19  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.1666667, 0.1666667  (x, y)</span></span>
<span><span class="co">#&gt; extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; sources     : wc2.1_10m_bio_1.tif  </span></span>
<span><span class="co">#&gt;               wc2.1_10m_bio_2.tif  </span></span>
<span><span class="co">#&gt;               wc2.1_10m_bio_3.tif  </span></span>
<span><span class="co">#&gt;               ... and 16 more sources</span></span>
<span><span class="co">#&gt; names       : wc2.1~bio_1, wc2.1~bio_2, wc2.1~bio_3, wc2.1~bio_4, wc2.1~bio_5, wc2.1~bio_6, ... </span></span>
<span><span class="co">#&gt; min values  :   -54.72435,     1.00000,    9.131122,       0.000,   -29.68600,   -72.50025, ... </span></span>
<span><span class="co">#&gt; max values  :    30.98764,    21.14754,  100.000000,    2363.846,    48.08275,    26.30000, ...</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the first bioclimatic variable: Annual Mean Temperature (Bio1)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">bioclim_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Annual Mean Temperature (Bio1)"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-20-1.png" width="672"></div>
<div class="rmdnote">
<ul>
<li>The function <code><a href="https://rdrr.io/pkg/raster/man/getData.html">getData()</a></code> retrieves <strong>bioclimatic variables</strong> from the <strong>WorldClim</strong> dataset.<br>
</li>
<li>
<code>var = "bio"</code> specifies that we want <strong>bioclimatic data</strong>, and <code>res = 10</code> sets the grid resolution to <strong>10 minutes</strong>.</li>
<li>The result, <code>bioclim_data</code>, is a <strong>RasterStack</strong> containing multiple environmental layers.</li>
</ul>
</div>
<hr>
<div id="key-bioclimatic-variables" class="section level5" number="4.4.0.1.1">
<h5>
<span class="header-section-number">4.4.0.1.1</span> <strong>Key Bioclimatic Variables</strong><a class="anchor" aria-label="anchor" href="#key-bioclimatic-variables"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="26%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th><strong>Variable Name</strong></th>
<th><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Bio1</strong></td>
<td>Annual Mean Temperature</td>
</tr>
<tr class="even">
<td><strong>Bio4</strong></td>
<td>Temperature Seasonality (Standard Deviation √ó 100)</td>
</tr>
<tr class="odd">
<td><strong>Bio12</strong></td>
<td>Annual Precipitation</td>
</tr>
<tr class="even">
<td><strong>Bio15</strong></td>
<td>Precipitation Seasonality (Coefficient of Variation)</td>
</tr>
</tbody>
</table></div>
<hr>
</div>
</div>
<div id="retrieving-species-occurrence-data" class="section level4" number="4.4.0.2">
<h4>
<span class="header-section-number">4.4.0.2</span> <strong>6.2. Retrieving Species Occurrence Data</strong><a class="anchor" aria-label="anchor" href="#retrieving-species-occurrence-data"><i class="fas fa-link"></i></a>
</h4>
<p>The <strong>Global Biodiversity Information Facility (GBIF)</strong> provides open-access data on species occurrences worldwide. Let‚Äôs retrieve occurrence data for the <strong>African lion</strong> (<em>Panthera leo</em>).</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster/sdm/">dismo</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a file path to save the data</span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="st">"lion_gbif_data.rds"</span></span>
<span></span>
<span><span class="co"># Check if the data already exists locally</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Load the data from the local file</span></span>
<span>  <span class="va">lion_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/serialize.html">readRDS</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Data loaded from local file."</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># Retrieve the data from GBIF and save it locally</span></span>
<span>  <span class="va">lion_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dismo/man/gbif.html">gbif</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="st">"Panthera"</span>, species <span class="op">=</span> <span class="st">"leo"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/serialize.html">saveRDS</a></span><span class="op">(</span><span class="va">lion_data</span>, <span class="va">file_path</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Data downloaded and saved locally."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Data loaded from local file.</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset the first 300 records for demonstration</span></span>
<span><span class="va">lion_data_subset</span> <span class="op">&lt;-</span> <span class="va">lion_data</span></span>
<span></span>
<span><span class="co"># to limit the point to view, for example, 3000 points:</span></span>
<span><span class="co"># lion_data_subset &lt;- lion_data[1:3000, ]</span></span>
<span></span>
<span><span class="co"># Plot the occurrence data on a world map</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span><span class="op">(</span><span class="st">"world"</span>, col <span class="op">=</span> <span class="st">"gray90"</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>, bg <span class="op">=</span> <span class="st">"lightblue"</span>, lwd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html">points</a></span><span class="op">(</span><span class="va">lion_data_subset</span><span class="op">$</span><span class="va">lon</span>, <span class="va">lion_data_subset</span><span class="op">$</span><span class="va">lat</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">10</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-spatial-data-basic-1_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
<div class="rmdcaution">
<ul>
<li>
<strong>Data quality check</strong>:<br>
Always inspect GBIF data for <strong>missing values</strong> and <strong>incorrect coordinates</strong> before using it in models.<br>
In particular, check for <code>NA</code> values in the longitude (<code>lon</code>) and latitude (<code>lat</code>) columns.</li>
</ul>
</div>
<hr>
</div>
<div id="summary-and-key-takeaways-1" class="section level3" number="4.4.1">
<h3>
<span class="header-section-number">4.4.1</span> <strong>7. Summary and Key Takeaways</strong><a class="anchor" aria-label="anchor" href="#summary-and-key-takeaways-1"><i class="fas fa-link"></i></a>
</h3>
<hr>
<p>In this tutorial, we covered several essential steps for working with spatial data in R, particularly focusing on <strong>Species Distribution Modeling (SDM)</strong>.</p>
<div id="summary-table" class="section level4" number="4.4.1.1">
<h4>
<span class="header-section-number">4.4.1.1</span> <strong>Summary Table</strong><a class="anchor" aria-label="anchor" href="#summary-table"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="25%">
<col width="29%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th><strong>Concept</strong></th>
<th><strong>Key Functions</strong></th>
<th><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Vector Data</strong></td>
<td>
<code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf()</a></code>, <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform()</a></code>
</td>
<td>Creating, transforming, and plotting vector data.</td>
</tr>
<tr class="even">
<td><strong>Raster Data</strong></td>
<td>
<code><a href="https://rdrr.io/pkg/raster/man/raster.html">raster()</a></code>, <code><a href="https://rdrr.io/pkg/raster/man/stack.html">stack()</a></code>, <code><a href="https://rspatial.github.io/terra/reference/writeRaster.html">writeRaster()</a></code>
</td>
<td>Creating and manipulating raster layers.</td>
</tr>
<tr class="odd">
<td><strong>CRS Handling</strong></td>
<td>
<code><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs()</a></code>, <code><a href="https://rspatial.github.io/terra/reference/project.html">project()</a></code>
</td>
<td>Checking and transforming Coordinate Reference Systems (CRS).</td>
</tr>
<tr class="even">
<td><strong>Environmental Data</strong></td>
<td><code><a href="https://rdrr.io/pkg/raster/man/getData.html">getData()</a></code></td>
<td>Downloading global bioclimatic variables for SDM.</td>
</tr>
<tr class="odd">
<td><strong>Species Occurrence Data</strong></td>
<td><code><a href="https://rdrr.io/pkg/dismo/man/gbif.html">gbif()</a></code></td>
<td>Retrieving species occurrence data from GBIF.</td>
</tr>
</tbody>
</table></div>
<hr>
</div>
</div>
<div id="key-takeaways-5" class="section level3" number="4.4.2">
<h3>
<span class="header-section-number">4.4.2</span> <strong>Key Takeaways</strong><a class="anchor" aria-label="anchor" href="#key-takeaways-5"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdimportant">
<ol style="list-style-type: decimal">
<li>Always ensure that your <strong>spatial datasets share the same CRS</strong> before performing any analysis.</li>
<li>Use reliable sources for <strong>environmental data</strong>, such as <strong>WorldClim</strong>, and carefully inspect <strong>species occurrence data</strong> from GBIF.</li>
<li>Properly handle and visualize both vector and raster data in R using functions from packages like <code>sf</code>, <code>raster</code>, and <code>dismo</code>.</li>
</ol>
</div>
<hr>
</div>
</div>
<div id="task" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Task<a class="anchor" aria-label="anchor" href="#task"><i class="fas fa-link"></i></a>
</h2>
<p>Try and do the following tasks to test your knowledge:</p>
<div class="inline-figure"><img src="images/Picture1-task1.png" width="600"></div>
<div class="inline-figure"><img src="images/Picture2-tak1.png" width="598"></div>
<div class="inline-figure"><img src="images/Picture3-task3.png" width="596"></div>
<hr>
<div id="next-steps" class="section level3" number="4.5.1">
<h3>
<span class="header-section-number">4.5.1</span> <strong>Next Steps</strong><a class="anchor" aria-label="anchor" href="#next-steps"><i class="fas fa-link"></i></a>
</h3>
<hr>
<p>In the next part, we will dive deeper into:</p>
<ul>
<li>
<strong>Advanced spatial analysis techniques</strong>:
<ul>
<li>Buffering, spatial joins, and overlay operations.</li>
</ul>
</li>
<li>
<strong>Building SDMs</strong>:
<ul>
<li>Using machine learning methods (e.g., MaxEnt, Random Forest) to predict species distributions.</li>
</ul>
</li>
<li>
<strong>Predictive modeling</strong>:
<ul>
<li>Projecting species distributions under <strong>future climate scenarios</strong> using environmental datasets.</li>
</ul>
</li>
</ul>
<hr>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="understanding-spatial-data.html"><span class="header-section-number">3</span> Understanding Spatial Data</a></div>
<div class="next"><a href="key-spatial-concepts-and-terminologies.html"><span class="header-section-number">5</span> Key Spatial Concepts and Terminologies</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#spartial-data-in-r"><span class="header-section-number">4</span> Spartial Data in R</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#introduction-1"><span class="header-section-number">4.0.1</span> 1. Introduction</a></li></ul>
</li>
<li>
<a class="nav-link" href="#working-with-vector-data-in-r"><span class="header-section-number">4.1</span> ### 2. Working with Vector Data in R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#summary"><span class="header-section-number">4.1.1</span> Summary</a></li>
<li><a class="nav-link" href="#creating-and-manipulating-raster-data-in-r"><span class="header-section-number">4.1.2</span> 3. Creating and Manipulating Raster Data in R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#working-with-coordinate-reference-systems-crs"><span class="header-section-number">4.2</span> ### 4. Working with Coordinate Reference Systems (CRS)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#key-takeaways-3"><span class="header-section-number">4.2.1</span> Key Takeaways</a></li></ul>
</li>
<li>
<a class="nav-link" href="#reading-and-writing-spatial-data"><span class="header-section-number">4.3</span> ### 5. Reading and Writing Spatial Data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#key-takeaways-4"><span class="header-section-number">4.3.1</span> Key Takeaways</a></li></ul>
</li>
<li>
<a class="nav-link" href="#practical-applications-in-sdm"><span class="header-section-number">4.4</span> ### 6. Practical Applications in SDM</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#summary-and-key-takeaways-1"><span class="header-section-number">4.4.1</span> 7. Summary and Key Takeaways</a></li>
<li><a class="nav-link" href="#key-takeaways-5"><span class="header-section-number">4.4.2</span> Key Takeaways</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#task"><span class="header-section-number">4.5</span> Task</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#next-steps"><span class="header-section-number">4.5.1</span> Next Steps</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/03-spatial-data-basic-1.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/03-spatial-data-basic-1.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Minimal Book Example</strong>" was written by Basim Alsaedi. It was last built on 2025-02-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
